# 快速啟動指南

## 🚀 最簡單的啟動方式

### 方式一：使用診斷工具（推薦）

1. **進入 backend 目錄**
   ```
   cd backend
   ```

2. **執行診斷工具**
   ```
   診斷問題.bat
   ```
   
   這個工具會：
   - 檢查 Python 環境
   - 檢查必要套件
   - 檢查端口占用
   - 自動啟動服務

### 方式二：直接啟動

1. **進入 backend 目錄**
   ```
   cd backend
   ```

2. **啟動服務**
   ```
   python app.py
   ```
   或
   ```
   python main.py
   ```

3. **開啟瀏覽器**
   訪問：http://localhost:5001/

---

## ❌ 常見問題排除

### 問題 1：找不到 Python

**錯誤訊息：**
```
'python' 不是內部或外部命令
```

**解決方法：**
1. 確認已安裝 Python 3.8 或更高版本
2. 確認 Python 已加入系統 PATH
3. 或使用完整路徑，例如：`C:\Python39\python.exe app.py`

---

### 問題 2：端口 5001 已被占用

**錯誤訊息：**
```
Address already in use
```

**解決方法：**

**方法 A：關閉占用端口的程式**
```bash
# 查看占用端口的進程
netstat -ano | findstr ":5001"

# 終止進程（將 PID 替換為實際的進程 ID）
taskkill /PID <進程ID> /F
```

**方法 B：使用其他端口**
1. 編輯 `backend/.env` 檔案
2. 修改 `PORT=5001` 為其他端口，例如 `PORT=5002`
3. 重新啟動服務
4. 訪問：http://localhost:5002/

---

### 問題 3：缺少必要套件

**錯誤訊息：**
```
ModuleNotFoundError: No module named 'flask'
```

**解決方法：**
```bash
cd backend
pip install -r requirements.txt
```

如果遇到 Pillow 安裝問題（Python 3.13），可以單獨安裝：
```bash
pip install Flask Flask-CORS Flask-JWT-Extended Flask-SQLAlchemy PyMySQL googlemaps requests openpyxl python-docx pandas reportlab python-dotenv loguru
```

---

### 問題 4：找不到 .env 檔案

**解決方法：**
1. 進入 `backend` 目錄
2. 複製範本檔案：
   ```bash
   copy env_template.txt .env
   ```
3. 編輯 `.env` 檔案，填入 Google Maps API Key：
   ```
   GOOGLE_MAPS_API_KEY=your-api-key-here
   ```

---

### 問題 5：瀏覽器顯示「無法連接到後端服務」

**檢查步驟：**

1. **確認服務已啟動**
   - 查看終端視窗是否有錯誤訊息
   - 應該看到：`啟動 Flask 服務在 http://0.0.0.0:5001`

2. **測試健康檢查**
   - 在瀏覽器訪問：http://localhost:5001/health
   - 應該看到：`{"status": "ok"}`

3. **檢查防火牆**
   - Windows 防火牆可能阻擋了連接
   - 暫時關閉防火牆測試

4. **檢查 CORS 設定**
   - 確認前端使用的 URL 與後端一致
   - 前端應該使用：`window.location.origin + '/api'`

---

### 問題 6：地圖圖片無法顯示

**檢查步驟：**

1. **確認地圖目錄存在**
   ```bash
   cd backend
   mkdir temp\maps
   ```

2. **檢查路由**
   - 訪問：http://localhost:5001/temp/maps/（應該顯示 404，但表示路由正常）
   - 如果顯示其他錯誤，檢查 `main.py` 或 `app.py` 中的路由設定

3. **檢查圖片路徑**
   - 前端應該使用相對路徑：`/temp/maps/圖片檔名.png`
   - 不應該使用：`http://localhost:5001/temp/maps/...`

---

## 🔍 詳細診斷步驟

### 步驟 1：檢查 Python 環境
```bash
python --version
```
應該顯示 Python 3.8 或更高版本

### 步驟 2：檢查必要套件
```bash
cd backend
python -c "import flask, flask_cors, dotenv; print('所有套件已安裝')"
```

### 步驟 3：檢查端口
```bash
netstat -ano | findstr ":5001"
```
如果沒有輸出，表示端口可用

### 步驟 4：檢查目錄結構
```bash
cd backend
dir app.py
dir main.py
dir .env
```

### 步驟 5：查看日誌
```bash
cd backend
type logs\app.log
```
查看最新的錯誤訊息

---

## 📞 需要更多幫助？

如果以上方法都無法解決問題，請提供：

1. **錯誤訊息**（完整的終端輸出）
2. **Python 版本**：`python --version`
3. **作業系統**：Windows 版本
4. **啟動方式**：使用的啟動命令或腳本
5. **日誌檔案**：`backend/logs/app.log` 的內容

---

## ✅ 成功啟動的標誌

當服務成功啟動時，您應該看到：

```
啟動 Flask 服務在 http://0.0.0.0:5001
健康檢查: http://localhost:5001/health
 * Running on http://127.0.0.1:5001
```

然後在瀏覽器訪問 http://localhost:5001/ 應該能看到系統首頁。


