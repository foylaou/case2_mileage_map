# Excel 範例檔案說明

## 檔案列表

### 1. 出差系統範例.xlsx
- **筆數**：6 筆
- **用途**：基本測試
- **包含**：2 個計畫別，基本資料

### 2. 出差系統完整範例.xlsx（推薦）
- **筆數**：10 筆
- **用途**：完整功能測試
- **包含**：2 個計畫別，多種情況

## 檔案結構

所有範例檔案包含以下**必要欄位**：

| 欄位名稱 | 說明 | 範例 |
|---------|------|------|
| 部門 | 部門名稱 | 安環處 |
| 姓名 | 員工姓名 | 張三 |
| 計畫別 | 專案計畫名稱 | IDA智慧工安 |
| 起點名稱 | 出發地點 | 安環高雄處 |
| 出差日期時間（開始） | 開始時間 | 2024-10-22 09:00 |
| 出差日期時間（結束） | 結束時間 | 2024-10-22 17:00 |
| 目的地名稱 | 目的地 | 經濟部產業園區管理局 |
| IsDriving | 是否自駕 (Y/N) | Y |

## 使用方式

### 1. 上傳測試

1. 開啟前端頁面：http://localhost:8000/excel-upload.html
2. 點選「選擇檔案」
3. 選擇 `出差系統完整範例.xlsx`
4. 點選「上傳並解析」

### 2. 預期結果

- ✅ 成功解析 10 筆資料
- ✅ 自動分組為 2 個計畫別：
  - IDA智慧工安：5 筆
  - 智慧製造：5 筆
- ✅ 顯示資料預覽
- ✅ 可以選擇需要計算里程的項目（IsDriving=Y）

### 3. 測試流程

1. **上傳 Excel** → 應該看到資料預覽
2. **設定固定起點**（可選）→ 例如：高雄市前鎮區復興四路12號
3. **選擇要計算的項目** → 勾選 IsDriving=Y 的項目
4. **開始計算** → 系統會呼叫 Google Maps API 計算距離
5. **查看結果** → 顯示公里數和地圖縮圖
6. **匯出 Excel** → 下載包含計算結果的 Excel
7. **匯出 Word** → 下載依計畫別分組的 Word 報表

## 注意事項

### 地點名稱對應

系統需要將地點名稱轉換為完整地址。目前支援的地點包括：

- 安環高雄處
- 總公司
- 經濟部產業園區管理局
- 高雄市政府
- 科技園區
- 工業區管理處

如果使用其他地點名稱，系統會提示需要手動輸入完整地址。

### 日期時間格式

Excel 檔案中的日期時間欄位應為：
- 格式：`YYYY-MM-DD HH:MM` 或 Excel 日期時間格式
- 範例：`2024-10-22 09:00`

### IsDriving 欄位

- **Y**：需要計算里程（自駕）
- **N**：不需要計算里程（非自駕）

系統會自動識別以下值為 Y：
- Y, YES, 是, TRUE, 1

其他值會被視為 N。

## 重新產生範例檔案

如果需要重新產生範例檔案，執行：

```bash
cd case2_mileage_map/backend
py generate_complete_sample.py
```

## 自訂範例檔案

您可以修改範例檔案來測試不同情況：

1. **測試空值處理**：將某些日期時間欄位留空
2. **測試多個計畫別**：新增更多不同的計畫別
3. **測試大量資料**：複製多筆資料測試效能
4. **測試特殊字元**：在名稱中加入特殊字元

## 疑難排解

### Q: 上傳後顯示「缺少必要欄位」

**解決方法：**
- 確認 Excel 檔案包含所有必要欄位
- 檢查欄位名稱是否完全一致（注意全形/半形字元）

### Q: 日期時間解析錯誤

**解決方法：**
- 確認日期時間欄位格式正確
- 避免使用文字格式的日期

### Q: 地點名稱無法對應

**解決方法：**
- 使用系統支援的地點名稱
- 或在後端 `services/place_mapping.py` 中新增地點對應







